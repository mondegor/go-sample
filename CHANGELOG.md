# Go Sample Changelog
Все изменения сервиса Go Sample будут документироваться на этой странице.

## 2023-12-07
### Changed
- Доработаны настройки конфига, добавлены `APPX_SERVER_*` и другие переменные;
- Добавлено управление callstack в отладочном режиме (cм. `mrerr.SetCallStackOptions`);
- Префикс в записях логов теперь стал необязательным параметром;
- Переработана работа с ошибками под новое ядро системы, в связи с этим:
    - из `mrcore.FactoryErrServiceEntityNotFound` удалены параметры;
    - для обработки `tagVersion` теперь используется `mrcore.FactoryErrServiceEntityVersionInvalid`;
    - `mrcore.FactoryErrServiceTemporarilyUnavailable` заменено на `uc.serviceHelper.WrapErrorFailed`;
    - `uc.serviceHelper.WrapErrorForSelect` -> `uc.serviceHelper.WrapErrorEntityNotFoundOrFailed`;
    - `mrcore.FactoryErrServiceIncorrectSwitchStatus` -> `mrcore.FactoryErrServiceSwitchStatusRejected`;
    - добавлены ошибки: `FactoryErrCategoryImageNotFound`, `FactoryErrProductNotFound`;
- Добавлен механизм виртуальных файловых провайдеров (S3 хранилищ).
  В конфиге прописан виртуальный файловый провайдер `imageStorage` с привязкой к реальному бакету S3 хранилища.
  Его уже используют другие модули системы. Тем самым убрана прямая зависимость модулей от реального бакета.
- В контроллере из `category.go` функционал работы с изображениями перенесён в `category_images.go`;
- Доработана структура БД, добавлены тестовые данные. Схема `public` переименована в `gosample`.
  Для каждого юнита добавлена своя константа с названием схемы БД;
- Изменения в REST API:
    - добавлен `App.Response.Model.ErrorList` (массив `App.Response.Model.ErrorAttribute`);
    - переименован `App.Response.Model.Error` -> `App.Response.Model.ErrorDetails`;
    - переименовано поле у `App.Response.Model.ErrorDetails`: `detail` -> `details`;
- Теперь юниты используют обращение друг к другу через API.
  Для этого вместо storageCategory и storageTrademark ранее используемые юнитом product добавлены соответствующие CategoryServiceAPI и TrademarkServiceAPI;

## 2023-11-23
### Changed
- Отладочная информация о загрузке картинки теперь вызывается из пакета mrdebug;

### Fixed
- Добавлен пропущенный cursor.Err();
- поправлено неправильная замена module.DBSchema в GetMetaData; 

## 2023-11-23
### Changed
- Обновлены зависимости библиотеки;

## 2023-11-20
### Changed
- Обновлена REST API документация, подключена её сборка в OpenAPI формате;
- Доработана работа с тегом версии сущности, которая позволяет избежать сохранения устаревших данных;
- Большинство объектов mrcore.FactoryErrServiceIncorrectInputData заменено на mrcore.FactoryErrServiceEntityNotFound;
- Название схемы данных БД вынесена в константу module.DBSchema;
- Доработан конфиг приложения, добавлен ModulesSettings для настроек модулей;
- Переименовано:
    - `mrcore.ClientData` -> `mrcore.ClientContext`;
    - `ClientContext::ParseAndValidate` -> `ClientContext::Validate` (удалён `ClientContext::Parse`);
- Обновлены зависимости от библиотек, доработаны компоненты под новое ядро системы;
- Обновлён `.editorconfig`;

## 2023-11-13
### Changed
- В системе выделены два модуля, которые не зависимы друг от друга. В связи с этим удалён префикс `Catalog` у всех сущностей, т.к. теперь и так понятно в каком модуле они находятся.
- Переименованы некоторые переменные и функции (типа Id -> ID) в соответствии с code style языка go;
- Доработаны компоненты работающие с файлами под новый интерфейс `FileProviderAPI`;
- Тексты SQL запросов приведены к единому стилю;
- Обновлены зависимости от библиотек, доработаны компоненты под новое ядро системы;
- Все файлы библиотеки были пропущены через `gofmt`;

## 2023-11-01
### Added
- Внедрена работа с пользовательскими разрешениями и привилегиями (ролевая модель) для каждого модуля, добавлены настройки для ролей в `config`;
- Реализована поддержка фильтров и компонентов `Sorter` и `Pager` для списков API (обработка запроса, построение SQL фрагментов);
- Логика каждого модуля разделена на независимые API (для примера `public` и `admin-api`);
- Добавлен контроллер для загрузки картинок в `public API`;
- В `.gitignore` добавлена директория `/golang` которую создаёт докер;

### Changed
- Переименованы следующие сущности:
    - `mrcom_status` -> `mrenum`;
    - `mrcom_orderer` -> `mrorderer`;
- Обновлены зависимости библиотеки;

## 2023-10-09
### Changed
- Обновлены зависимости библиотеки;
- Обработка ошибок приведена к более компактному виду;
- Переработаны фильтры списков;
- Доработана работа со статусами и их переключениями;

### Fixed
- Добавлены настройки `APPX_REDIS_*` и `APPX_S3_*` для правильного запуска сервиса в докере;

## 2023-09-20
### Changed
- Обновлены зависимости библиотеки;
- Фиксация зависимостей инфраструктуры;
- Заменён адаптер `*mrpostgres.ConnAdapter` на интерфейс `mrstorage.DbConn`;
- Заменены tabs на пробелы в коде;

## 2023-09-16
### Add
- К категориям продукции добавлена возможность прикрепления изображений;
- Добавлено поле UpdateAt для всех объектов;

### Changed
- Все объекты, которые создаются при запуске сервиса перенесены в пакет `factory`;
